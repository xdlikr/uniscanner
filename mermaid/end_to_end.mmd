sequenceDiagram
    participant U as ðŸ‘¤ ä½ 
    participant M as ðŸ§¾ ModeManager
    participant D as ðŸ“¥ Data Pipeline
    participant L as ðŸ§  LLM Agents
    participant S as âš–ï¸ Scoring Engine
    participant P as ðŸ›¡ï¸ Portfolio & Risk
    participant E as ðŸ’¼ Execution
    participant Mon as ðŸ“Š Monitor/Audit

    U->>M: æŸ¥çœ‹/è®¾ç½®æ¨¡å¼ï¼ˆSIM/DRY_RUN/LIVEï¼‰
    M->>D: å…è®¸æ¯æ—¥ä»»åŠ¡è¿è¡Œï¼Ÿ

    D->>D: æŠ“å–è¡Œæƒ…/è´¢æŠ¥/æ–°é—»/å®è§‚
    D->>D: æ¸…æ´—/å¯¹é½/å­˜å‚¨æ•°æ®

    D->>L: ä¼ å…¥æ–°è´¢æŠ¥/æ–°é—»/å®è§‚æ–‡æœ¬
    L->>L: å„ Agent ç”Ÿæˆç»“æž„åŒ– JSON åˆ†æž
    L->>S: ä¼ å…¥ earnings/news/industry/macro scores

    S->>S: è®¡ç®—ç»¼åˆå¾—åˆ† CompositeScore
    S->>S: ç”Ÿæˆ Buy/Hold/Sell ä¿¡å·
    S->>P: ä¼ å…¥ä¿¡å· + å½“å‰æŒä»“

    P->>P: Portfolio Builder ç”Ÿæˆç›®æ ‡ä»“ä½
    P->>P: RiskManager æŒ‰å®ªæ³•è£å‰ªä»“ä½
    P->>E: ä¼ å…¥â€œåˆæ³•åŽçš„ç›®æ ‡ä»“ä½â€

    E->>E: è®¡ç®—è®¢å•ï¼šä¹°å…¥/å–å‡ºæ•°é‡
    E->>E: åº”ç”¨æ‰§è¡Œè§„åˆ™ï¼ˆä»·æ ¼/é¢‘æ¬¡æ ¡éªŒï¼‰
    alt LIVE æ¨¡å¼ & é€šè¿‡é£ŽæŽ§
        E->>Broker: é€šè¿‡ API å‘é€è®¢å•
        Broker-->>E: è¿”å›žæˆäº¤ç»“æžœ
    else DRY_RUN/SIM
        E->>E: åªè®°å½•ï¼Œä¸çœŸå®žä¸‹å•
    end

    E->>Mon: è®°å½•è®¢å•ä¸Žæˆäº¤æ—¥å¿—
    S->>Mon: è®°å½•è¯„åˆ†ä¸Žä¿¡å·
    L->>Mon: è®°å½• LLM è¾“å…¥/è¾“å‡º
    P->>Mon: è®°å½•é£Žé™©ä¸Žä»“ä½å˜åŒ–
    Mon->>U: ä»ªè¡¨ç›˜ & å‘Šè­¦